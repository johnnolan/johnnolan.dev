var Perfume=function(){"use strict";var n=function(){function t(t){this.config=t}return t.prototype.now=function(){return Date.now()/1e3},t.prototype.mark=function(t,e){},t.prototype.measure=function(t,e){return this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){var e=this;setTimeout(function(){t(e.getFirstPaint())})},t.prototype.getDurationByMetric=function(t,e){return e.end-e.start||0},t.prototype.getFirstPaint=function(){var t=window.performance.timing,e={duration:0,entryType:"paint",name:"first-contentful-paint",startTime:0};return t&&0!==t.navigationStart&&(e.startTime=Date.now()-t.navigationStart),[e]},t}(),t=function(){function t(){}return t.prototype.create=function(){var e=this;"PerformanceLongTaskTiming"in window&&(this.g=window.__tti={e:[]},this.g.o=new PerformanceObserver(function(t){e.g.e=e.g.e.concat(t.getEntries())}),this.g.o.observe({entryTypes:["longtask"]}))},t}();!function(o,s){var n,i,r,e=[],a={passive:!0,capture:!0},t=new Date,c="pointerup",u="pointercancel";function f(t,e){n||(n=e,i=t,r=new Date,h(s),p())}function p(){0<=i&&i<r-t&&(e.forEach(function(t){t(i,n)}),e=[])}function l(t){if(t.cancelable){var e=(1e12<t.timeStamp?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){function n(){f(t,e),r()}function i(){r()}function r(){s(c,n,a),s(u,i,a)}o(c,n,a),o(u,i,a)}(e,t):f(e,t)}}function h(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(t){e(t,l,a)})}h(o),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(t){e.push(t),p()}}(addEventListener,removeEventListener);var p="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,i=(function(f){!function(){var i="undefined"!=typeof window&&window===this?this:void 0!==p&&null!=p?p:this,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};function n(){n=function(){},i.Symbol||(i.Symbol=t)}var r=0;function t(t){return"jscomp_symbol_"+(t||"")+r++}function o(){n();var t=i.Symbol.iterator;t||(t=i.Symbol.iterator=i.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&e(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return s(this)}}),o=function(){}}function s(t){var e,n=0;return e=function(){return n<t.length?{done:!1,value:t[n++]}:{done:!0}},o(),(e={next:e})[i.Symbol.iterator]=function(){return this},e}function l(t){o();var e=t[Symbol.iterator];return e?e.call(t):s(t)}function h(t){if(!(t instanceof Array)){t=l(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}var d=0;var m="img script iframe link audio video source".split(" ");function g(t,e){for(var n=(t=l(t)).next();!n.done;n=t.next())if(n=n.value,e.includes(n.nodeName.toLowerCase())||g(n.children,e))return!0;return!1}function v(t,e){if(2<t.length)return performance.now();for(var n=[],i=(e=l(e)).next();!i.done;i=e.next())i=i.value,n.push({timestamp:i.start,type:"requestStart"}),n.push({timestamp:i.end,type:"requestEnd"});for(i=(e=l(t)).next();!i.done;i=e.next())n.push({timestamp:i.value,type:"requestStart"});for(n.sort(function(t,e){return t.timestamp-e.timestamp}),t=t.length,e=n.length-1;0<=e;e--)switch(i=n[e],i.type){case"requestStart":t--;break;case"requestEnd":if(2<++t)return i.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function a(t){t=t||{},this.w=!!t.useMutationObserver,this.u=t.minValue||null,t=window.__tti&&window.__tti.e;var r,o,s,a,c,u,f,i,n,e,p=window.__tti&&window.__tti.o;this.a=t?t.map(function(t){return{start:t.startTime,end:t.startTime+t.duration}}):[],p&&p.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,r=this.m.bind(this),o=this.l.bind(this),s=XMLHttpRequest.prototype.send,a=d++,XMLHttpRequest.prototype.send=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n-0]=arguments[n];var i=this;return r(a),this.addEventListener("readystatechange",function(){4===i.readyState&&o(a)}),s.apply(this,e)},c=this.m.bind(this),u=this.l.bind(this),f=fetch,fetch=function(t){for(var r=[],e=0;e<arguments.length;++e)r[e-0]=arguments[e];return new Promise(function(e,n){var i=d++;c(i),f.apply(null,[].concat(h(r))).then(function(t){u(i),e(t)},function(t){u(t),n(t)})})},(i=this).c=new PerformanceObserver(function(t){for(var e=(t=l(t.getEntries())).next();!e.done;e=t.next())if("resource"===(e=e.value).entryType&&(i.b.push({start:e.fetchStart,end:e.responseEnd}),y(i,v(i.g,i.b)+5e3)),"longtask"===e.entryType){var n=e.startTime+e.duration;i.a.push({start:e.startTime,end:n}),y(i,n+5e3)}}),i.c.observe({entryTypes:["longtask","resource"]}),this.w&&(this.h=(n=this.B.bind(this),(e=new MutationObserver(function(t){for(var e=(t=l(t)).next();!e.done;e=t.next())"childList"==(e=e.value).type&&g(e.addedNodes,m)?n(e):"attributes"==e.type&&m.includes(e.target.tagName.toLowerCase())&&n(e)})).observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),e))}function c(t){t.i=!0;var e=0<t.a.length?t.a[t.a.length-1].end:0,n=v(t.g,t.b);y(t,Math.max(n+5e3,e))}function y(o,t){!o.i||o.v>t||(clearTimeout(o.j),o.j=setTimeout(function(){var t=performance.timing.navigationStart,e=v(o.g,o.b);t=(window.a&&window.a.A?1e3*window.a.A().C-t:0)||performance.timing.domContentLoadedEventEnd-t;if(o.u)var n=o.u;else performance.timing.domContentLoadedEventEnd?n=(n=performance.timing).domContentLoadedEventEnd-n.navigationStart:n=null;var i=performance.now();null===n&&y(o,Math.max(e+5e3,i+1e3));var r=o.a;i-e<5e3?e=null:e=i-(e=r.length?r[r.length-1].end:t)<5e3?null:Math.max(e,n),e&&(o.s(e),clearTimeout(o.j),o.i=!1,o.c&&o.c.disconnect(),o.h&&o.h.disconnect()),y(o,performance.now()+1e3)},t-performance.now()),o.v=t)}a.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t){e.s=t,"complete"==document.readyState?c(e):window.addEventListener("load",function(){c(e)})})},a.prototype.m=function(t){this.f.set(t,performance.now())},a.prototype.l=function(t){this.f.delete(t)},a.prototype.B=function(){y(this,performance.now()+5e3)},i.Object.defineProperties(a.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return[].concat(h(this.f.values()))}}});var u={getFirstConsistentlyInteractive:function(t){return t=t||{},"PerformanceLongTaskTiming"in window?new a(t).getFirstConsistentlyInteractive():Promise.resolve(null)}};f.exports?f.exports=u:window.ttiPolyfill=u}()}(e={exports:{}},e.exports),e.exports);(new t).create();var r=function(){function t(t){this.config=t,this.timeToInteractiveDuration=0,this.ttiPolyfill=i}return t.supported=function(){return window.performance&&!!performance.now&&!!performance.mark},t.supportedPerformanceObserver=function(){return window.chrome&&"PerformanceObserver"in window},t.supportedLongTask=function(){return"PerformanceLongTaskTiming"in window},t.prototype.now=function(){return window.performance.now()},t.prototype.mark=function(t,e){var n="mark_"+t+"_"+e;window.performance.mark(n)},t.prototype.measure=function(t,e){var n="mark_"+t+"_start",i="mark_"+t+"_end";return window.performance.measure(t,n,i),this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){this.perfObserver=new PerformanceObserver(this.performanceObserverCb.bind(this,t)),this.perfObserver.observe({entryTypes:["paint"]})},t.prototype.timeToInteractive=function(t){return this.ttiPolyfill.getFirstConsistentlyInteractive({minValue:t})},t.prototype.getDurationByMetric=function(t,e){var n=this.getMeasurementForGivenName(t);return n&&"measure"===n.entryType?n.duration:-1},t.prototype.getMeasurementForGivenName=function(t){var e=window.performance.getEntriesByName(t);return e[e.length-1]},t.prototype.performanceObserverCb=function(t,e){var n=this,i=e.getEntries();t(i),i.forEach(function(t){n.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&n.perfObserver.disconnect()})},t}(),o=function(o,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{r(c.next(t))}catch(t){e(t)}}function i(t){try{r(c.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,i)}r((c=c.apply(o,s||[])).next())})},s=function(n,i){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};return function(){function t(t){void 0===t&&(t={});var e=this;this.config={firstContentfulPaint:!1,firstPaint:!1,firstInputDelay:!1,timeToInteractive:!1,googleAnalytics:{enable:!1,timingVar:"name"},logPrefix:"Perfume.js:",logging:!0,warning:!1},this.firstPaintDuration=0,this.firstContentfulPaintDuration=0,this.firstInputDelayDuration=0,this.timeToInteractiveDuration=0,this.isHidden=!1,this.logMetricWarn="Please provide a metric name",this.metrics=new Map,this.observers=new Map,this.didVisibilityChange=function(){document.hidden&&(e.isHidden=document.hidden)},this.config=Object.assign({},this.config,t),this.perf=r.supported()?new r(this.config):new n(this.config),r.supportedPerformanceObserver()||(this.perfEmulated=new n(this.config)),this.observeFirstContentfulPaint=new Promise(function(t){e.observers.set("fcp",t),e.initFirstPaint()}),this.observeFirstInputDelay=new Promise(function(t){e.observers.set("fid",t),e.initFirstInputDelay()}),this.onVisibilityChange(),this.observeTimeToInteractive=new Promise(function(n){return o(e,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return this.observers.set("tti",n),[4,this.observeFirstContentfulPaint];case 1:return e=t.sent(),this.initTimeToInteractive(e),[2]}})})})}return t.prototype.start=function(t){this.checkMetricName(t)&&(this.metrics.has(t)?this.logWarn(this.config.logPrefix,"Recording already started."):(this.metrics.set(t,{end:0,start:this.perf.now()}),this.perf.mark(t,"start"),this.isHidden=!1))},t.prototype.end=function(t){if(this.checkMetricName(t)){var e=this.metrics.get(t);if(e){e.end=this.perf.now(),this.perf.mark(t,"end");var n=this.perf.measure(t,e),i=parseFloat(n.toFixed(2));return this.log(t,i),this.metrics.delete(t),this.sendTiming(t,i),i}this.logWarn(this.config.logPrefix,"Recording already stopped.")}},t.prototype.endPaint=function(n){var i=this;return new Promise(function(e){setTimeout(function(){var t=i.end(n);e(t)})})},t.prototype.log=function(t,e){if(!this.isHidden&&this.config.logging)if(t){var n=e.toFixed(2),i="%c "+this.config.logPrefix+" "+t+" "+n+" ms";window.console.log(i,"color: #ff6d00;font-size:12px;")}else this.logWarn(this.config.logPrefix,this.logMetricWarn)},t.prototype.sendTiming=function(t,e){if(!this.isHidden&&(this.config.analyticsTracker&&this.config.analyticsTracker(t,e),this.config.googleAnalytics.enable))if(window.ga){var n=Math.round(e);window.ga("send","timing",t,this.config.googleAnalytics.timingVar,n)}else this.logWarn(this.config.logPrefix,"Google Analytics has not been loaded")},t.prototype.checkMetricName=function(t){return!!t||(this.logWarn(this.config.logPrefix,this.logMetricWarn),!1)},t.prototype.firstContentfulPaintCb=function(t){var e=this;t.forEach(function(t){e.config.firstPaint&&"first-paint"===t.name&&e.logMetric(t.startTime,"First Paint","firstPaint"),e.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&e.logMetric(t.startTime,"First Contentful Paint","firstContentfulPaint")})},t.prototype.initFirstPaint=function(){r.supportedPerformanceObserver()?this.perf.firstContentfulPaint(this.firstContentfulPaintCb.bind(this)):this.perfEmulated&&this.perfEmulated.firstContentfulPaint(this.firstContentfulPaintCb.bind(this))},t.prototype.initTimeToInteractive=function(t){var e=this;r.supported()&&r.supportedPerformanceObserver()&&r.supportedLongTask()&&this.config.timeToInteractive&&t&&this.perf.timeToInteractive(t).then(function(t){e.logMetric(t,"Time to Interactive","timeToInteractive")})},t.prototype.initFirstInputDelay=function(){var n=this;r.supported()&&this.config.firstInputDelay&&perfMetrics.onFirstInputDelay(function(t,e){n.logMetric(t,"First Input Delay","firstInputDelay")})},t.prototype.onVisibilityChange=function(){void 0!==document.hidden&&document.addEventListener("visibilitychange",this.didVisibilityChange)},t.prototype.logMetric=function(t,e,n){var i=parseFloat(t.toFixed(2));"firstPaint"===n&&(this.firstPaintDuration=i),"firstContentfulPaint"===n&&(this.firstContentfulPaintDuration=i,this.observers.get("fcp")(i)),"firstInputDelay"===n&&(this.firstInputDelayDuration=i,this.observers.get("fid")(i)),"timeToInteractive"===n&&(this.timeToInteractiveDuration=i,this.observers.get("tti")(i)),this.log(e,i),this.sendTiming(n,i)},t.prototype.logWarn=function(t,e){this.config.warning&&this.config.logging&&window.console.warn(t,e)},t}()}();